{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "GEDCOM Parser - Internal Name Block",
  "description": "Canonical internal representation of an individual's name, derived from GEDCOM NAME structures and normalized for scoring and entity resolution.",
  "type": "object",

  "properties": {

    "raw": {
      "type": "string",
      "description": "Exact GEDCOM NAME value, preserved without modification."
    },

    "type": {
      "type": "string",
      "description": "GEDCOM NAME type (e.g., birth, married, aka). Defaults to 'unknown'.",
      "enum": [
        "birth",
        "married",
        "aka",
        "adopted",
        "immigrant",
        "legal",
        "unknown"
      ]
    },

    "script": {
      "type": "string",
      "description": "Script or writing system of the name (Latin, Cyrillic, etc.).",
      "enum": [
        "latin",
        "cyrillic",
        "arabic",
        "hebrew",
        "greek",
        "hangul",
        "han",
        "thai",
        "unknown"
      ]
    },

    "parsed": {
      "type": "object",
      "description": "Structured components extracted from the raw GEDCOM NAME and child tags.",
      "properties": {
        "prefix": { "type": ["string", "null"] },
        "title": { "type": ["string", "null"] },
        "given": { "type": ["string", "null"] },
        "middle": { "type": ["string", "null"] },
        "nickname": { "type": ["string", "null"] },
        "surname_prefix": { "type": ["string", "null"] },
        "surname": { "type": ["string", "null"] },
        "suffix": { "type": ["string", "null"] },
        "maiden_name": { "type": ["string", "null"] },

        "additional_tokens": {
          "type": "array",
          "description": "Tokens that appear to be genealogist annotations, noise, or miscellaneous items.",
          "items": { "type": "string" }
        },

        "notes": {
          "type": "array",
          "description": "Notes extracted from GEDCOM NAME.NOTE, if any.",
          "items": { "type": "string" }
        },

        "warnings": {
          "type": "array",
          "description": "Warnings emitted during parsing (e.g., ambiguous surname prefix).",
          "items": { "type": "string" }
        }
      },
      "required": [
        "given",
        "surname"
      ]
    },

    "normalized": {
      "type": "object",
      "description": "Canonical normalized values generated by normalize_name_block().",
      "properties": {
        "given": { "type": ["string", "null"] },
        "middle": { "type": ["string", "null"] },
        "nickname": { "type": ["string", "null"] },
        "surname_prefix": { "type": ["string", "null"] },
        "surname": { "type": ["string", "null"] },
        "suffix": { "type": ["string", "null"] },
        "title": { "type": ["string", "null"] },

        "full": {
          "type": "string",
          "description": "Normalized full name string reconstructed from cleaned name parts."
        },

        "full_sortable": {
          "type": "string",
          "description": "Sortable version of name, typically 'Surname, Given Middle'."
        },

        "canonical_key": {
          "type": "string",
          "description": "Machine-stable canonical identity key used for blocking and entity matching."
        }
      },
      "required": [
        "given",
        "surname",
        "full",
        "canonical_key"
      ]
    }
  },

  "required": ["raw", "parsed", "normalized"]
}
